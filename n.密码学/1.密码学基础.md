
# 密码发展史

1949年，Shannon发表了“保密系统的通信理论（Communication Theory of Secrecy Systems)一文，为密码学的发展奠定了坚实的理论基础，此后的密码技术才真正称得上密码学。提出了保密系统的数学模型、随机密码、纯密码、完善保密性、理想保密系统、唯一解距离、理论保密性和实际保密性等重要概念，并提出评价保密系统的5条标准，即保密度、密钥量、加密操作的复杂性、误差传播和消息扩展。（第一次飞跃）

1976年后，美国数据加密标准（DES）的公布使密码学的研究公开，密码学得到了迅速发展。（里程碑）

1976年，Diffe和Hellman发表了《密码学的新方向》，提出了一种新的密码设计思想，从而开创了公钥密码学的新纪元。（第二次飞跃）

1978年由Rivest、Shamire和Adleman首先提出第一个实用的公钥密码体制RSA，使公钥密码的研究进入了快速发展阶段。（里程碑）
发展阶段

密码学发展大致分为以下三个阶段，前两个阶段又称为传统密码。

## 古典密码时期
起始时间：从古代到19世纪末，长达几千年。

技术工具：手工。

通信手段：信使。

密码体制：纸、笔或者简单器械实现的代换及置换，是一种艺术（富有创造性的方式、方法）。

典型密码：凯撒密码、维吉尼亚密码等。

## 近代密码时期

起始时间：从20世纪初到20世纪50年代，即一战及二战时期。

技术工具：机械设备。

通信手段：电报。

密码体制：手工或电动机械实现复杂的代换及置换，仍是一门艺术。

典型密码：Vernam密码、转轮密码等。

## 现代密码时期
起始时间：从1949年至今。

技术工具：计算机。（针对二进制的比特位，而不是字符）

通信手段：无线通信、有线通信、计算网络等。

密码体制：对称密码（分组密码、序列密码）和非对称密码（公钥密码），有坚实的数学理论基础，成为一门科学。

典型密码：DES、AES、RC4、RSA、SHA等。


# 密码主要功能

- **机密性**
机密性是指保证信息不泄露给非授权的用户或实体，**确保存储的信息和传输的信息仅能被授权的各方得到**，而非授权用户即使得到信息也无法知晓信息内容，不能使用。


- **完整性**
完整性是指信息未经授权**不能进行改变的**特征，维护信息的一致性，即信息在生成、传输、存储和使用过程中不应发生人为或非人为的非授权篡改（插入、替换、删除、重排序等），如果发生，能够及时发现。

- **认证性**
认证性是指确保一个信息的来源或源本身被正确地标识，同时确保该标识的真实性，分为实体认证和消息认证。
**消息认证是指能向接收方保证该信息确实来自于它所宣称的源**。
实体认证是指参与信息处理的实体是可信的，即每个实体的确是它所宣称的那个实体，使得任何其它实体不能假冒这个实体。

- **不可否认性**
不可否认性是**防止发送方或接收方抵赖所传输的信息**，要求无论发送方还是接收方都不能抵赖所进行的行为。因此，当发送方发送一个信息时，接收方能证实该信息的确是由所宣称的发送方发来的；当接收方收到一个信息时，发送方能够证实该信息的确送到了指定的接收方。

# 密码系统的组成

一个密码系统（System）是由明文（Plaintext)、密文（Ciphertext)、密钥（Key）、加密算法（Encryption Algorithm）和解密算法（Decryption Algorithm）五部分组成的，即s={M,C,K,E,D}。

- 信息的原始形式称为明文。

- 明文经过编码变换所生成的称为密文。

- 密钥是指控制明文与密文之间相互变换的，分为加密密钥和解密密钥。

- 对明文进行编码变换生成密文的过程称为加密，编码的规则称为加密算法。

- 将密文恢复出明文的过程称为解密，恢复的规则称为解密算法。


![](http://qiniu.liulei.life/202207051349749.png)

在对称加密中加密秘钥和解密秘钥可能是同一个


# 密码分析学/破译

研究如何分析或破解各种密码编码体制的一门科学。密码分析**俗称为密码破译**，是指在密码通信过程中，非授权者在不知道解密密钥的条件下对密文进行分析，试图得到明文或密钥的过程。


## 密码攻击类型


1. **惟密文攻击（Ciphertext Only Attack) COA**

   密码分析者除了拥有**截获的密文**外（**密码算法也已知**），没有其它可以利用的信息。密码分析者的任务是恢复尽可能多的明文，或者最好能推算出解密密钥，这样就很容易解出被加密的信息。这种攻击的方法至少可采用穷举搜索法，即对截获一定数量的密文依次用所有的密钥尝试，直到得到有意义的明文。在这种情况下进行密码破译是最困难的，经不起这种攻击的密码体制被认为是完全不安全的。（仅仅搭线窃听）.


1. **已知明文攻击（Known Plaintext Attack) KPA**

    密码分析者不仅掌握了相当数量的密文，还有一些**已知的明-密文对**可供利用。密码分析者的任务就是用密文信息推导出解密密钥或导出一个替代算法，此算法可以对所获得的密文恢复出相应的明文。
    

1. **选择明文攻击（Chosen Plaintext Attack) CPA**

   定义：选择明文攻击(CPA)是指攻击者除了知道加密算法外，还可以选定明文消息，从而得到加密后的密文，即知道选择的明文和加密的密文，但是不能直接攻破密钥。（暂时控制加密机）

1. **选择密文攻击（Chosen Ciphertext Attack) CCA**

    密码分析者能选择不同被**加密的密文，并还可得到对应的明文**，密码分析者的任务是推出密钥及其它密文对应的明文。

    这种情况往往是密码分析者通过某种手段**暂时控制加密机和解密机**。

 总结： 

<table>
<tr>
    <th>种类</th>
    <th>简单理解</th>
    <th>难易</th>
</tr>
<tr>
    <td>惟密文攻击</td>
    <td>只知道密文，推出明文或密钥，一般用穷举攻击。
    </td>
    <td>最难</td>
</tr>
<tr>
    <td>已知明文攻击</td>
    <td>知道部分的明文和密文对，推出密钥和加密算法。
    </td>
    <td>难
    </td>
</tr>
<tr>
    <td>选择明文攻击</td>
    <td>暂时控制加密机，逆推出秘钥和加解密算法
    </td>
    <td>易
    </td>
</tr>
<tr>
    <td>选择密文攻击</td>
    <td>暂时控制加、解密机，推出加解密算法和秘钥
    </td>
    <td>最易
    </td>
</tr>
</table>

难易程度：选择密文攻击(CCA)＜选择明文攻击(CPA)＜已知明文攻击(KPA)＜唯密文攻击(COA)

对于现代密码体制的基本要求：**不仅要经受得住惟密文攻击，而且要经受得住已知明文攻击。（有内奸）**


## 攻击方法


- 穷举法

    方法： 遍历所有秘钥
    时间：次数*解密一次时间
    抵御攻击：秘钥空间足够大


- 统计分析攻击

    方法：密码分析者通过分析密文和明文的统计规律来破译密码
    
    抵御攻击：使明文的统计特征尽可能地不带入密文。如果密文不带有明文的痕迹，那么统计分析攻击成为不可能。（譬如重合指数法）

- 数学分析法

    方法密码分析者针对加密变换所依赖的数学难题（如大整数的素因子分解、离散对数等），通过数学求解的方法（如二次筛法、积分指数法等）来设法找到相应的解密变化，从而实现破译。
    
    抵御攻击： 选用具有坚实的数学基础和足够复杂的加密方法

# 密码体制的安全性

**无条件安全性**

无条件安全也称信息论安全（Information-theoretic security），敌手即使拥有无限的计算能力也能保障密码系统的安全性，也就是说，通过密文敌手无法获取关于明文的任何信息。最简单的例子就是一次一密的加密算法，复杂点的像承诺算法等都是信息论安全的。


**计算安全性**

计算安全，是目前大多公钥密码学原型能保证的，一般这种公钥密码学方法都基于某种安全性假设，而这种安全性假设在计算上是安全的，例如大整数因式分解、离散对数假设等等。

任何密码总有一天都会被破译的。

**可证明安全性**

通过有效的转化，将对密码体制的任何有效攻击归约到解一类已知难处理问题，即使用多项式归约技术形式化证明一种密码体制的安全性，称为可证明安全性。
譬如，如果给定大整数的素因子分解是不可行的，那么RSA密码体制是不可破解的。

这种方法只是说明了安全性和另一个问题相关的，并没有完全证明它是安全的。






# 常用的加密方式

![](http://qiniu.liulei.life/202207051524001.png)
- 对称加密

- 非对称加密

- 单向散列函数

    - 哈希函数

- 消息认证码 

- 数字签名

- 证书 

- ssl/tls - https

## 对称加密

密钥：在加密和解密使用同一个密钥

使用方式：
假设有A、B两人，A使用密钥进行加密，B使用相同的密钥进行解密


![](http://qiniu.liulei.life/20220701112728.png)

根据上图D没有密钥，所以无法解密，但是此种情况要防止密钥泄露

特点

- 双向保证机密性

- 加密的效率很高，适合加密大数据，大文件

- 加密强度不高，相对于非对称加密

## 非对称加密

密钥：加密和解密使用不同的密钥
- 公钥：是公开出来的密钥

    使用公钥加密，私钥解密

- 私钥：需要妥善保管的密钥，知道的人越少越好

    使用私钥加密，公钥解密


![](http://qiniu.liulei.life/20220701112318.png)

如上图，虽然 D能够拦截，并解析出明文，但是他只有公钥，当使用公钥加密篡改后的消息时，A、B、C无法解密，所以非对称加密无法篡改



如果是A、B、C向E发送数据，则D由于没有私钥则无法解密，结合上图，说明数据只能保证单向机密

![](http://qiniu.liulei.life/20220701112209.png)

特点：

- 数据只能单向保证机密

- 非对称加密，无法被篡改

- 加密强度较高，相对于对称加密

# 凯撒密码

恺撒密码（Caesar cipher）是一种相传尤利乌斯·恺撒曾使用过的密码。恺撒于公元前100年左右诞生于古罗马，是一位著名的军事统帅。

> 恺撤密码是通过将明文中所使用的字母表按照一定的字数“平移”来进行加密的。

![](http://qiniu.liulei.life/20220701154107.png)

凯撒密码加解密公式


- 加密

    ![](http://qiniu.liulei.life/20220701154416.png)

- 解密

    ![](http://qiniu.liulei.life/20220701154536.png)



凯撒密码是符合加密三要素的

- 明文/密文

    明文: 小写字母表中的数据

    密文: 大写字母表中的数据

- 秘钥
    按照上图秘钥为3

- 算法

    加密: +3

    解密: -3

|安全性：通过暴力破解，即可得出偏移量

